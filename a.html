<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ساخت دیتابیس با HTML و JavaScript</title>
</head>
<body>
    <h1>فرم ثبت نام</h1>
    <form id="myForm">
        <label for="name">نام:</label>
        <input type="text" id="name" required>
        <br>
        <label for="email">ایمیل:</label>
        <input type="email" id="email" required>
        <br>
        <button type="submit">ثبت اطلاعات</button>
    </form>

    <h2>لیست ثبت نام کنندگان</h2>
    <ul id="userList"></ul>
    <a href="soheilss3.github.io/images.png download >ss</a>
    <script>
        document.getElementById('myForm').addEventListener('submit', function (event) {
            event.preventDefault();
            
            const name = sanitizeInput(document.getElementById('name').value);
            const email = sanitizeInput(document.getElementById('email').value);

            // بررسی اعتبار ایمیل
            if (!validateEmail(email)) {
                alert("ایمیل معتبر نیست.");
                return;
            }

            // ذخیره داده‌ها در Local Storage
            const userData = {
                name: name,
                email: email
            };

            const users = JSON.parse(localStorage.getItem('users')) || [];
            users.push(userData);
            localStorage.setItem('users', JSON.stringify(users));

            // نمایش کاربران
            displayUsers();
            document.getElementById('myForm').reset();
        });

        function displayUsers() {
            const users = JSON.parse(localStorage.getItem('users')) || [];
            const userList = document.getElementById('userList');
            userList.innerHTML = '';

            users.forEach(function (user) {
                const listItem = document.createElement('li');
                listItem.textContent = `نام: ${user.name}, ایمیل: ${user.email}`;
                userList.appendChild(listItem);
            });
        }

        // اعتبارسنجی ایمیل
        function validateEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(String(email).toLowerCase());
        }

        // جلوگیری از تزریق کد
        function sanitizeInput(input) {
            const element = document.createElement('div');
            element.innerText = input; // استفاده از innerText برای جلوگیری از تزریق کد
            return element.innerHTML; // به دست آوردن ورودی ایمن
        }

        // نمایش کاربران در بارگذاری صفحه
        window.onload = displayUsers;
    </script>
</body>
</html>
